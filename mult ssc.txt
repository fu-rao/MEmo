转至元数据起始 1.按照正常调试单颗Accel Sensor的流程，添加好相应的驱动代码，配置好相应的编译条件

2. android/vendor/qcom/proprietary/sensors/dsps/reg_defaults/sensor_def_qcomdev.conf这个文件的配置如下


1900 0 0x00010001 #Maj Ver  设置为0表示 enable sensor的自动匹配功能
1901 2 0x00010001 #Min Ver




#屏蔽掉单颗Accel Sensor模式下寄存器的配置

#1903 0x8b70bb577c06f1bc 0x00010001 #UUID
#1902 0xf04d0ecefa4d8290 0x00010001 #UUID
#1904 10000 0x00010001 #off_to_idle
#1905 30000 0x00010001 #idle_to_ready
#1906 1 0x00010001 #i2c_bus
#1907 1000 0x00010001 #reg_group_id
#1908 0 0x00010001 #cal_grp_id
#1909 96 0x00010001 #gpio1
#1910 36 0x00010001 #gpio2
#1911 0 0x00010001 #sensor_id
#1912 0x18 0x00010001 #i2c_address
#1913 1 0x00010001 #data_type1
#1914 0 0x00010001 #data_type2
#1915 -1 0x00010001 #rel_sns_idx
#1916 1 0x00010001 #sens_default
#1917 0xD0 0x00010001 #flags
#1982 0 0x00010001 #device_select
#1987 0x02 0x00010001 #vdd
#1988 0x02 0x00010001 #vddio







2000 2 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_MIN_VER_NO_V02  此版本号务必改成2
2001 2 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_NUM_UUID_VALID_V02 兼容的Accel  sensor的数量




#配置第一颗Accel Sensor的相关寄存器
#Accel lis2ds12
2003 0xad14a3b713403ca5 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG0_UUID_LOW_V02
2002 0x034c566b9c37cec6 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG0_UUID_HIGH_V02
2004 10000 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG0_OFF_TO_IDLE_V02
2005 30000 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG0_IDLE_TO_READY_V02
2006 96 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG0_GPIO1_V02
2007 1000 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG0_REG_GROUP_ID_V02
2008 0 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG0_CAL_PRI_GROUP_ID_V02
2009 1 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG0_I2C_BUS_V02
2010 0x1D 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG0_I2C_ADDRESS_V02
2011 1 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG0_SENSITIVITY_DEFAULT_V02
2012 0xD0 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG0_FLAGS_V02
2068 0x02 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG0_VDD_RAIL_V02
2069 0x02 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG0_VDDIO_RAIL_V02




#配置第二颗Accel Sensor的相关寄存器
#Accel BMA425
2014 0x8b70bb577c06f1bc 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG1_UUID_LOW_V02
2013 0xf04d0ecefa4d8290 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG1_UUID_HIGH_V02
2015 10000 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG1_OFF_TO_IDLE_V02
2016 30000 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG1_IDLE_TO_READY_V02
2017 96 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG1_GPIO1_V02
2018 1000 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG1_REG_GROUP_ID_V02
2019 0 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG1_CAL_PRI_GROUP_ID_V02
2020 1 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG1_I2C_BUS_V02
2021 0x18 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG1_I2C_ADDRESS_V02
2022 1 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG1_SENSITIVITY_DEFAULT_V02
2023 0xD0 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG1_FLAGS_V02
2070 0x02 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG1_VDD_RAIL_V02
2071 0x02 0x00010001 #SNS_REG_ITEM_SSI_DEVINFO_ACCEL_CFG1_VDDIO_RAIL_V02







3.Accel Sensor驱动中的probe函数内，一定要引入对器件的自我识别，代码如下：

// Check WhoAmIRegister to make sure this is the correct driver
status = sns_ddf_read_port(
port_handle,
STM_LIS2DS12_WHO_AM_I,
&i2c_buff,
1, 
&rw_bytes);
if((status != SNS_DDF_SUCCESS ) ||
(rw_bytes != 1))
{
sns_ddf_close_port( port_handle );
return SNS_DDF_EFAIL;
}
if(i2c_buff != STM_LIS2DS12_WHOAMI_VALUE)
{
/* Incorrect value. Return now with nothing detected */
sns_ddf_close_port( port_handle );
return SNS_DDF_SUCCESS;
}




4.Accel Sensor驱动中的init函数内，要对sensor坐标系进行调整，以实现对两颗Sensor的坐标系的兼容，代码如下：

static uint8_t bma4_axis_dflt[3] = {-1, -2, 3};

sns_ddf_axes_map_init(axes_map, bma4_axis_dflt);

